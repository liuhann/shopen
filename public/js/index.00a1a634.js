(function(e){function t(t){for(var r,i,o=t[0],u=t[1],c=t[2],l=0,f=[];l<o.length;l++)i=o[l],a[i]&&f.push(a[i][0]),a[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);d&&d(t);while(f.length)f.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var o=n[i];0!==a[o]&&(r=!1)}r&&(s.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},i={index:0},a={index:0},s=[];function o(e){return u.p+"js/"+({"designer~frame-tool~style-tool":"designer~frame-tool~style-tool",designer:"designer","frame-tool":"frame-tool","style-tool":"style-tool",site:"site",user:"user"}[e]||e)+"."+{"designer~frame-tool~style-tool":"45f46f55",designer:"842dfea3","frame-tool":"9a322ed1","style-tool":"74cf1401",site:"3be99061",user:"e2598dbf"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={"designer~frame-tool~style-tool":1,designer:1,"frame-tool":1,"style-tool":1,site:1,user:1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=new Promise(function(t,n){for(var r="css/"+({"designer~frame-tool~style-tool":"designer~frame-tool~style-tool",designer:"designer","frame-tool":"frame-tool","style-tool":"style-tool",site:"site",user:"user"}[e]||e)+"."+{"designer~frame-tool~style-tool":"1a5268ce",designer:"d6d6c79e","frame-tool":"048ba05b","style-tool":"17cb6131",site:"0e433876",user:"41610593"}[e]+".css",a=u.p+r,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var c=s[o],l=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(l===r||l===a))return t()}var f=document.getElementsByTagName("style");for(o=0;o<f.length;o++){c=f[o],l=c.getAttribute("data-href");if(l===r||l===a)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||a,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.request=r,delete i[e],d.parentNode.removeChild(d),n(s)},d.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(d)}).then(function(){i[e]=0}));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var s=new Promise(function(t,n){r=a[e]=[t,n]});t.push(r[2]=s);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=o(e),c=function(t){l.onerror=l.onload=null,clearTimeout(f);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+r+": "+i+")");s.type=r,s.request=i,n[1](s)}a[e]=void 0}};var f=setTimeout(function(){c({type:"timeout",target:l})},12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/",u.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var f=0;f<c.length;f++)t(c[f]);var d=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("f161")},"1d3a":function(e,t,n){"use strict";var r=n("8df7"),i=n.n(r);i.a},"520f":function(e,t,n){},"62ab":function(e,t,n){},"655c":function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return f});var r=n("bd86"),i=n("5176"),a=n.n(i),s=n("a745"),o=n.n(s),u=n("7618");function c(e){return e&&"object"===Object(u["a"])(e)&&!o()(e)}function l(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(!n.length)return e;var s=n.shift();if(c(e)&&c(s))for(var o in s)c(s[o])?(e[o]||a()(e,Object(r["a"])({},o,{})),l(e[o],s[o])):a()(e,Object(r["a"])({},o,s[o]));return l.apply(void 0,[e].concat(n))}function f(e){if(null==e||"object"!==Object(u["a"])(e))return e;if(e instanceof Array){for(var t=[],n=0,r=e.length;n<r;n++)t[n]=f(e[n]);return t}if(e instanceof Object){var i={};for(var a in e)e.hasOwnProperty(a)&&(i[a]=f(e[a]));return i}return e}},"8df7":function(e,t,n){},aa3f:function(e,t,n){},f161:function(e,t,n){"use strict";n.r(t);n("96cf");var r=n("3b8d"),i=(n("cadf"),n("551c"),n("f751"),n("097d"),n("520f"),n("62ab"),n("aa3f"),n("2fce")),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},s=[],o={name:"view.vue",data:function(){return{}},computed:{}},u=o,c=n("2877"),l=Object(c["a"])(u,a,s,!1,null,null,null),f=l.exports,d=n("2b0e"),h=n("8c4f"),p={routes:[{path:"/",component:function(){return n.e("site").then(n.bind(null,"9ac0"))}}],onload:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},y={routes:[{path:"/designer/:type?",component:function(){return Promise.all([n.e("designer~frame-tool~style-tool"),n.e("designer")]).then(n.bind(null,"499d"))}}]},v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"danke-runtime"},e._l(e.scenes,function(t,r){return n("div",{key:r,staticClass:"scene",style:t.style},e._l(t.elements,function(t,r){return n("div",{key:t.id,staticClass:"element-wrapper",style:t.style,on:{click:function(t){return e.onElementClicked(r)}}},[e._v("\r\n      "+e._s(t.content)+"\r\n    ")])}),0)}),0)},m=[],g=n("5d73"),b=n.n(g),k=n("d225"),w=n("b0b4"),x=n("b162"),j=n.n(x),O=function(){function e(t,n){Object(k["a"])(this,e),this.device=n,this.scenes=t,this.displays={current:null,fore:null,back:null},this.index=-1,this.initSceneStyleAttr()}return Object(w["a"])(e,[{key:"setDevice",value:function(e){this.device=e}},{key:"hasNext",value:function(){return this.scenes.length-1>this.index}},{key:"next",value:function(){if(this.index++,this.index>this.scenes.length-1)this.playEndCallback&&this.playEndCallback(this);else{this.displays.current&&this.leaveScene(this.displays.current),this.displays.current=this.scenes[this.index];while("slide"!==this.displays.current.type)this.index++,this.displays.current=this.scenes[this.index];this.checkForBack(),this.enterScene(this.displays.current)}}},{key:"checkForBack",value:function(){for(var e=null,t=null,n=this.index;n>-1;n--)if(e||"background"!==this.scenes[n].type||(e=this.scenes[n]),t||"foreground"!==this.scenes[n].type||(t=this.scenes[n]),e&&t)break;e&&e!==this.displays.back&&(this.enterScene(e),this.displays.back&&this.leaveScene(this.displays.back),this.displays.back=e),t&&t!==this.displays.fore&&(this.enterScene(t),this.displays.fore&&this.leaveScene(this.displays.fore),this.displays.fore=t)}},{key:"initSceneStyleAttr",value:function(){for(var e=0;e<this.scenes.length;e++){var t=this.scenes[e];if(t.style="display: none",t.elements){var n=!0,r=!1,i=void 0;try{for(var a,s=b()(t.elements);!(n=(a=s.next()).done);n=!0){var o=a.value;o.style=""}}catch(u){r=!0,i=u}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}t.index=e}}},{key:"enterScene",value:function(e){this.renderEnter(e),this.sceneEnterCallback&&this.sceneEnterCallback(this),e.duration&&"slide"===e.type&&(this.pauseForLeave=j.a.setTimeout(this.next.bind(this),e.duration))}},{key:"renderEnter",value:function(e){var t=this,n=!0,r=!1,i=void 0;try{for(var a,s=function(){var e=a.value;e.style=styleUtils.getElementStyle(e,t.device,"in"),e.existence.animation&&e.existence.duration&&j.a.setTimeout(function(){e.style=styleUtils.getElementStyle(e,t.device,"existence")},e.in.duration+e.in.delay)},o=b()(e.elements);!(n=(a=o.next()).done);n=!0)s()}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e.style="display: inherit; ".concat(styleUtils.getSceneStyle(e,this.device))}},{key:"leaveScene",value:function(e){var t=this;this.renderLeave(e),this.sceneLeaveCallback&&this.sceneLeaveCallback(this),j.a.setTimeout(function(){e.style="display: none",t.sceneHideCallback&&t.sceneHideCallback(t)},e.hideDelay||3e3)}},{key:"renderLeave",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=b()(e.elements);!(t=(i=a.next()).done);t=!0){var s=i.value;s.style=styleUtils.getElementStyle(s,this.device,"out")}}catch(o){n=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"sceneEnter",value:function(e){this.sceneEnterCallback=e}},{key:"sceneLeave",value:function(e){this.sceneLeaveCallback=e}},{key:"sceneHide",value:function(e){this.sceneHideCallback=e}},{key:"playEnd",value:function(e){this.playEndCallback=e}}]),e}(),S=n("655c"),C={name:"Player",props:{},data:function(){return{scenes:[],device:{width:window.innerWidth,height:window.innerHeight}}},created:function(){var e=this;if(this.$route.params.id)this.ctx.workdao.getWork(this.$route.params.id).then(function(t){var n=new O(t.scenes,e.device);document.title="蛋壳分享:"+t.title,e.scenes=n.scenes,e.$nextTick(function(){n.next()})});else if(this.ctx.work){var t=Object(S["a"])(this.ctx.work),n=new O(t.scenes,this.device);document.title="蛋壳分享:"+t.title,this.scenes=n.scenes,this.$nextTick(function(){n.next()})}},methods:{onElementClicked:function(){}}},E=C,R=(n("1d3a"),Object(c["a"])(E,v,m,!1,null,null,null)),P=R.exports,_={routes:[{path:"/play/:id?",component:P}]},A=function(){function e(t){Object(k["a"])(this,e),this.ctx=t}return Object(w["a"])(e,[{key:"getCurrentUser",value:function(){return this.ctx.get("user/current").json()}},{key:"register",value:function(e,t,n){return this.ctx.post("user/register",{json:{name:e,password:t,nickname:n}}).json()}},{key:"login",value:function(e,t,n){return this.ctx.post("user/login",{json:{name:e,password:t,captcha:n}}).json()}},{key:"getCaptcha",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.ctx.get("captcha").json());case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"sendSmsCode",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.ctx.get("user/sms/".concat(t)).json());case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){}}]),e}(),T=A,L={routes:[{path:"/user",component:function(){return n.e("user").then(n.bind(null,"d0f4"))}},{path:"/register",component:function(){return n.e("user").then(n.bind(null,"27c2"))}}],onload:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.userdao=new T(t);case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},U=function(){function e(t){Object(k["a"])(this,e),this.ctx=t}return Object(w["a"])(e,[{key:"addAnimation",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.ctx.put("animation",{json:t}).json());case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getAnimationList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.ctx.get("animation/list",{searchParams:{type:t,skip:n,limit:r}}).json());case 1:case"end":return e.stop()}},e,this)}));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"removeAnimation",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.ctx.delete("animation?_id=".concat(t),{searchParams:{_id:t}}).json());case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),H={routes:[{path:"/frame-tool",component:function(){return Promise.all([n.e("designer~frame-tool~style-tool"),n.e("frame-tool")]).then(n.bind(null,"c22b"))}},{path:"/frame-list",component:function(){return Promise.all([n.e("designer~frame-tool~style-tool"),n.e("frame-tool")]).then(n.bind(null,"a8a5"))}}],onload:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.animdao=new U(t);case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},M={routes:[{path:"/style-tool",component:function(){return Promise.all([n.e("designer~frame-tool~style-tool"),n.e("style-tool")]).then(n.bind(null,"1773"))}}],onload:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},B=n("d823");function N(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++){var i=Math.round(Math.random()*(n.length-1));t+=n.substring(i,i+1)}return t}function $(e){var t=window.localStorage.getItem("token");t||(t=N(10),window.localStorage.setItem("token",t));var n=B["a"].extend({prefixUrl:"http://www.danke.fun/api/",throwHttpErrors:!1,searchParams:{token:t}});e.ky=n,e.get=n.get,e.put=n.put,e.post=n.post,e.delete=n.delete}d["default"].use(h["a"]),window.Vue=d["default"];var F=new i["a"]({Vue:d["default"],VueRouter:h["a"],App:f,mode:"history",appServer:"http://www.danke.fun",cdn:"http://cdn.danke.fun",mount:"#app",packages:[p,y,_,L,H,M],started:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return $(t),e.next=3,t.userdao.getCurrentUser();case 3:return t.user=e.sent,e.next=6,n();case 6:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}(),upload:{maxSize:2097152}});F.startUp()}});
//# sourceMappingURL=index.00a1a634.js.map