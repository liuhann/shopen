(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{"037e":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"navbar is-fixed-top",attrs:{role:"navigation","aria-label":"main navigation"}},[a("div",{staticClass:"navbar-brand"},[t._m(0),a("a",{staticClass:"navbar-burger burger",class:t.burgerOpen,attrs:{role:"button","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"},on:{click:t.toggleOpen}},[a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}}),a("span",{attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"navbar-menu",class:t.burgerOpen,attrs:{id:"navbarBasicExample"}},[a("div",{staticClass:"navbar-start"},[a("router-link",{staticClass:"navbar-item",attrs:{to:"/"}},[t._v("首页")]),a("a",{staticClass:"navbar-item"},[t._v("\n        桌面\n      ")]),t._m(1)],1),a("div",{staticClass:"navbar-end"},[a("div",{staticClass:"navbar-item"},[t.avatar?a("figure",{staticClass:"image is-48x48",on:{click:t.goUserHome}},[a("img",{staticStyle:{"max-height":"48px!important"},attrs:{src:t.avatar,width:"48",height:"48"}})]):a("div",{staticClass:"buttons"},[a("a",{staticClass:"button is-primary",on:{click:t.getStarted}},[a("strong",[t._v("开始使用")])])])])])])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"navbar-item",attrs:{href:"https://bulma.io"}},[a("img",{attrs:{src:"http://www.danke.fun/res/logo.png"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"navbar-item has-dropdown is-hoverable"},[a("a",{staticClass:"navbar-link"},[t._v("\n          工具\n        ")]),a("div",{staticClass:"navbar-dropdown"},[a("a",{staticClass:"navbar-item",attrs:{href:"/style-tool"}},[t._v("\n            样式元素\n          ")]),a("a",{staticClass:"navbar-item",attrs:{href:"/frame-list"}},[t._v("\n            动画\n          ")]),a("a",{staticClass:"navbar-item"},[t._v("\n            轮播图\n          ")])])])}],n={name:"NavBar",props:{},data:function(){return{user:this.ctx.user,isMobileOpened:!1}},created:function(){},computed:{burgerOpen:function(){return this.isMobileOpened?"is-active":""},avatar:function(){return this.user&&this.user.id?this.user.avatar||this.ctx.cdn+"/res/user.png":null}},mounted:function(){var t=this;this.$router.beforeEach(function(e,a,r){t.isMobileOpened=!1,r()})},methods:{toggleOpen:function(){this.isMobileOpened=!this.isMobileOpened},getStarted:function(){this.$router.push("/user")},goUserHome:function(){this.$router.push("/user")}}},i=n,c=a("2877"),o=Object(c["a"])(i,r,s,!1,null,null,null);e["a"]=o.exports},"0390":function(t,e,a){"use strict";var r=a("02f4")(!0);t.exports=function(t,e,a){return e+(a?r(t,e).length:1)}},"214f":function(t,e,a){"use strict";a("b0c5");var r=a("2aba"),s=a("32e9"),n=a("79e5"),i=a("be13"),c=a("2b4c"),o=a("520a"),l=c("species"),u=!n(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),d=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var a="ab".split(t);return 2===a.length&&"a"===a[0]&&"b"===a[1]}();t.exports=function(t,e,a){var p=c(t),v=!n(function(){var e={};return e[p]=function(){return 7},7!=""[t](e)}),h=v?!n(function(){var e=!1,a=/a/;return a.exec=function(){return e=!0,null},"split"===t&&(a.constructor={},a.constructor[l]=function(){return a}),a[p](""),!e}):void 0;if(!v||!h||"replace"===t&&!u||"split"===t&&!d){var f=/./[p],m=a(i,p,""[t],function(t,e,a,r,s){return e.exec===o?v&&!s?{done:!0,value:f.call(e,a,r)}:{done:!0,value:t.call(a,e,r)}:{done:!1}}),g=m[0],b=m[1];r(String.prototype,t,g),s(RegExp.prototype,p,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}}},"27c2":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("nav-bar"),a("section",{staticClass:"login-panel box"},[a("h1",{staticClass:"title"},[t._v("注册")]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("手机号")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"input",class:t.error.username?"is-danger":"",attrs:{type:"text",placeholder:"输入手机号码"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t.error.username?a("p",{staticClass:"help is-danger"},[t._v(t._s(t.error.username))]):t._e()]),a("div",{staticClass:"field"},[t._m(0),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nickname,expression:"nickname"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.nickname},on:{input:function(e){e.target.composing||(t.nickname=e.target.value)}}})])]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("密码")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"input",class:t.error.password?"is-danger":"",attrs:{type:"password",placeholder:"输入密码"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t.error.password?a("p",{staticClass:"help is-danger"},[t._v(t._s(t.error.password))]):t._e()]),a("div",{staticClass:"field"},[a("div",{staticClass:"control"},[a("label",{staticClass:"checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?t._i(t.checked,null)>-1:t.checked},on:{change:function(e){var a=t.checked,r=e.target,s=!!r.checked;if(Array.isArray(a)){var n=null,i=t._i(a,n);r.checked?i<0&&(t.checked=a.concat([n])):i>-1&&(t.checked=a.slice(0,i).concat(a.slice(i+1)))}else t.checked=s}}}),t._v("\n          同意"),a("a",{attrs:{href:"#"}},[t._v("danke.fun 使用条款")])])])]),a("div",{staticClass:"field is-grouped"},[a("div",{staticClass:"control"},[a("button",{staticClass:"button is-success",attrs:{disabled:!t.checked},on:{click:t.doRegister}},[t._v("注册")])]),t._m(1)])])],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"label"},[t._v("用户名 "),a("span",{staticClass:"is-small"},[t._v("(可选)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"control"},[a("button",{staticClass:"button is-text"},[t._v("忘记密码")])])}],n=(a("a481"),a("96cf"),a("3b8d")),i=a("037e"),c={name:"Register",components:{NavBar:i["a"]},data:function(){return{username:"",checked:!0,error:{nickname:"",username:"",password:""},password:""}},created:function(){var t=this;setInterval(function(){0!==t.countDown&&t.countDown--},1e3)},methods:{doRegister:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!==this.username){t.next=3;break}return this.error.username="请输入用户名",t.abrupt("return");case 3:if(""!==this.password){t.next=6;break}return this.error.password="请输入密码",t.abrupt("return");case 6:return t.next=8,this.ctx.userdao.register(this.username,this.password,this.nickname);case 8:if(e=t.sent,400!==e.code){t.next=12;break}return this.error.username="手机号码格式不正确",t.abrupt("return");case 12:if(409!==e.code){t.next=15;break}return this.error.username="手机号码已经注册过",t.abrupt("return");case 15:e.token&&localStorage.setItem("token",e.token),this.$router.replace("/");case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},o=c,l=(a("6f3e"),a("2877")),u=Object(l["a"])(o,r,s,!1,null,null,null);e["default"]=u.exports},4801:function(t,e,a){},"520a":function(t,e,a){"use strict";var r=a("0bfb"),s=RegExp.prototype.exec,n=String.prototype.replace,i=s,c="lastIndex",o=function(){var t=/a/,e=/b*/g;return s.call(t,"a"),s.call(e,"a"),0!==t[c]||0!==e[c]}(),l=void 0!==/()??/.exec("")[1],u=o||l;u&&(i=function(t){var e,a,i,u,d=this;return l&&(a=new RegExp("^"+d.source+"$(?!\\s)",r.call(d))),o&&(e=d[c]),i=s.call(d,t),o&&i&&(d[c]=d.global?i.index+i[0].length:e),l&&i&&i.length>1&&n.call(i[0],a,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(i[u]=void 0)}),i}),t.exports=i},"5f1b":function(t,e,a){"use strict";var r=a("23c6"),s=RegExp.prototype.exec;t.exports=function(t,e){var a=t.exec;if("function"===typeof a){var n=a.call(t,e);if("object"!==typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return s.call(t,e)}},"6f3e":function(t,e,a){"use strict";var r=a("b790"),s=a.n(r);s.a},a481:function(t,e,a){"use strict";var r=a("cb7c"),s=a("4bf8"),n=a("9def"),i=a("4588"),c=a("0390"),o=a("5f1b"),l=Math.max,u=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,v=/\$([$&`']|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};a("214f")("replace",2,function(t,e,a,f){return[function(r,s){var n=t(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,n,s):a.call(String(n),r,s)},function(t,e){var s=f(a,t,this,e);if(s.done)return s.value;var d=r(t),p=String(this),v="function"===typeof e;v||(e=String(e));var g=d.global;if(g){var b=d.unicode;d.lastIndex=0}var C=[];while(1){var x=o(d,p);if(null===x)break;if(C.push(x),!g)break;var w=String(x[0]);""===w&&(d.lastIndex=c(p,n(d.lastIndex),b))}for(var _="",k=0,y=0;y<C.length;y++){x=C[y];for(var E=String(x[0]),$=l(u(i(x.index),p.length),0),O=[],R=1;R<x.length;R++)O.push(h(x[R]));var S=x.groups;if(v){var N=[E].concat(O,$,p);void 0!==S&&N.push(S);var M=String(e.apply(void 0,N))}else M=m(E,p,$,O,S,e);$>=k&&(_+=p.slice(k,$)+M,k=$+E.length)}return _+p.slice(k)}];function m(t,e,r,n,i,c){var o=r+t.length,l=n.length,u=v;return void 0!==i&&(i=s(i),u=p),a.call(c,u,function(a,s){var c;switch(s.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(o);case"<":c=i[s.slice(1,-1)];break;default:var u=+s;if(0===u)return a;if(u>l){var p=d(u/10);return 0===p?a:p<=l?void 0===n[p-1]?s.charAt(1):n[p-1]+s.charAt(1):a}c=n[u-1]}return void 0===c?"":c})}})},b0c5:function(t,e,a){"use strict";var r=a("520a");a("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},b790:function(t,e,a){},d0f4:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("nav-bar"),a("section",{staticClass:"login-panel box"},[a("h1",{staticClass:"title"},[t._v("登录")]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("用户名")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"input",attrs:{type:"text",placeholder:"输入用户名"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t.error.username?a("p",{staticClass:"help is-danger"},[t._v("用户名或密码不正确")]):t._e()]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("密码")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"input",attrs:{type:"password",placeholder:"输入密码"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),a("div",{staticClass:"field"},[a("label",{staticClass:"label"},[t._v("验证码")]),a("div",{staticClass:"control"},[a("span",{domProps:{innerHTML:t._s(t.svg)},on:{click:t.refreshCaptcha}})]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.captcha,expression:"captcha"}],staticClass:"input",domProps:{value:t.captcha},on:{input:function(e){e.target.composing||(t.captcha=e.target.value)}}})]),t.error.captcha?a("p",{staticClass:"help is-danger"},[t._v(t._s(t.error.captcha))]):t._e()]),a("div",{staticClass:"field is-grouped"},[a("div",{staticClass:"control"},[a("button",{staticClass:"button is-primary",on:{click:t.login}},[t._v("登录")])]),a("div",{staticClass:"control"},[a("button",{staticClass:"button is-text",on:{click:t.register}},[t._v("注册")])])])])],1)},s=[],n=(a("96cf"),a("3b8d")),i=a("037e"),c={name:"Home",components:{NavBar:i["a"]},data:function(){return{error:{captcha:"",username:""},captcha:"",svg:"",username:"",password:""}},created:function(){var t=this;setInterval(function(){0!==t.countDown&&t.countDown--},1e3)},mounted:function(){this.refreshCaptcha()},methods:{refreshCaptcha:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ctx.userdao.getCaptcha();case 2:e=t.sent,this.svg=e.svg;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),register:function(){this.$router.push("/register")},sendSmsCode:function(){0===this.countDown&&this.isPoneAvailable(this.phone)?(this.ctx.userdao.sendSmsCode(this.phone),this.countDown=90):this.ctx.vant.Dialog.alert({message:"错误的手机号码"})},login:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ctx.userdao.login(this.username,this.password,this.captcha);case 2:e=t.sent,400===e.code&&(this.error.captcha="验证码不正确",this.refreshCaptcha()),401===e.code&&(this.error.captcha="",this.error.username=e.message,this.captcha="",this.refreshCaptcha()),e.code;case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},o=c,l=(a("ec86"),a("2877")),u=Object(l["a"])(o,r,s,!1,null,null,null);e["default"]=u.exports},ec86:function(t,e,a){"use strict";var r=a("4801"),s=a.n(r);s.a}}]);
//# sourceMappingURL=user.e2598dbf.js.map